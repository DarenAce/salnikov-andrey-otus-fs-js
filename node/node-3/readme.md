# Node-3. Работа с потоками в NodeJS

Необходимо отсортировать большой файл со случайными целыми числами размером 100 МБ, в условиях ограниченной оперативной памяти - 50 МБ. Решение должно быть построено с использованием потоков.

Для решения задачи можно использовать алгоритм “Сортировка слиянием”.

Процесс можно разделить на 3 этапа.

Этап 0

Любым удобным вам способом создаем исходный файл с числами размером 100 МБ.

Этап 1

Исходный файл с числами необходимо разбить на несколько файлов поменьше, предварительно отсортировав их независимо друг от друга.

Этап 2

Необходимо создать механизм чтения чисел сразу из нескольких файлов (потоков). Читать данные из потоков следует по принципу pause/resume.

Этап 3

Необходимо создать цикл, который будет работать с данными сразу из всех потоков. Такой цикл будет прерван только тогда, когда будут полностью прочитаны все файлы. В цикле следует искать наименьшее значение и записывать его в итоговый файл. 1 итерация = 1 число.

Для проверки решения скрипт необходимо запустить командой `$ node --max-old-space-size=50 script.js`

## Реализация

Для запуска скрипта сортировки `sort.js` необходимо выполнить команду `npm run sort INPUT_FILE OUTPUT_FILE MEMORY_LIMIT`, где:

`INPUT_FILE` — путь к файлу, который надо отсортировать. В качестве разделителя чисел в файле должен исползоваться перенос строки (`\n`);

`OUTPUT_FILE` — путь к файлу, в который будут записаны отсортированные числа;

`MEMORY_LIMIT` — ограничение на используемую оперативную память в байтах.

Для генерации файла со случайными числами необходимо запустить скрипт `generate.js` командой `npm run generate [FILE_NAME] [FILE_SIZE] [LOWER_BOUND] [UPPER_BOUND]`, где:

`FILE_NAME` — путь к файлу, который будет создан. Значение по умолчанию — `./test.txt`;

`FILE_SIZE` — размер файла в байтах. Значение по умолчанию — `1 * 1024 * 1024` (1 МБ);

`LOWER_BOUND` — нижняя граница отрезка, в котором будут лежать сгенерированные числа. Значение по умолчанию — `Number.MIN_SAFE_INTEGER`;

`UPPER_BOUND` — верхняя граница отрезка, в котором будут лежать сгенерированные числа. Значение по умолчанию — `Number.MAX_SAFE_INTEGER`.
